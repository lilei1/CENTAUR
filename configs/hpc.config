/*
 * CENTAUR Pipeline Configuration
 * HPC/SLURM execution configuration
 */

process {
    // Resource allocation
    cpus = 8
    memory = '16.GB'
    time = '4.h'
    
    // Error handling
    errorStrategy = 'retry'
    maxRetries = 3
    
    // Specific process configurations
    withName: 'QUALITY_CONTROL_METHYLATION' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'ALIGN_METHYLATION' {
        cpus = 16
        memory = '32.GB'
        time = '8.h'
    }
    
    withName: 'CALL_METHYLATION' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'EXTRACT_FRAGMENTOMICS' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'QUALITY_CONTROL_RNA' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'ALIGN_RNA' {
        cpus = 16
        memory = '32.GB'
        time = '8.h'
    }
    
    withName: 'QUANTIFY_GENES' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'NORMALIZE_EXPRESSION' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'DIFFERENTIAL_EXPRESSION' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'CALCULATE_IMMUNE_SIGNATURES' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'CALL_SOMATIC_VARIANTS' {
        cpus = 16
        memory = '64.GB'
        time = '16.h'
    }
    
    withName: 'ANNOTATE_VARIANTS' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'CALCULATE_TMB' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'ANALYZE_CNV' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'HARMONIZE_SAMPLE_DATA' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'EXTRACT_BIOMARKER_FEATURES' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'CREATE_FEATURE_MATRIX' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
    
    withName: 'PERFORM_DIMENSIONALITY_REDUCTION' {
        cpus = 8
        memory = '16.GB'
        time = '4.h'
    }
    
    withName: 'GENERATE_FINAL_FEATURES' {
        cpus = 4
        memory = '8.GB'
        time = '2.h'
    }
}

// Execution configuration
executor {
    name = 'slurm'
    queueSize = 100
    submitRateLimit = '10/1min'
}

// SLURM configuration
slurm {
    queue = 'normal'
    account = 'your_account'
    partition = 'normal'
    time = '4:00:00'
    memory = '16GB'
    cpus = 8
    submitRateLimit = '10/1min'
}

// Workflow configuration
workflow {
    onComplete = 'echo "CENTAUR pipeline completed successfully!"'
    onError = 'echo "CENTAUR pipeline failed!"'
}

// Environment variables
env {
    PATH = '/usr/local/bin:/usr/bin:/bin'
    PYTHONPATH = '/usr/local/lib/python3.8/site-packages'
    SLURM_ACCOUNT = 'your_account'
    SLURM_PARTITION = 'normal'
}

// Docker configuration
docker {
    enabled = false
}

// Singularity configuration
singularity {
    enabled = true
    autoMounts = true
    cacheDir = '/tmp/singularity'
    runOptions = '--bind /data:/data --bind /scratch:/scratch'
}

// Conda configuration
conda {
    enabled = false
}

// Environment modules
modules {
    enabled = true
    load = ['python/3.8', 'r/4.0', 'samtools/1.12', 'bwa/0.7.17', 'gatk/4.2.0']
}
